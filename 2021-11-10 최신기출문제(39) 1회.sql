/**************************************************************
    PART 05 --- SQLD 최신기출문제
    SQLD 최신기출문제 (39회) 1회       p.304
***************************************************************/

/*******************************
    14. UNION ALL 다음에 MINUS
    하면 어떤 결과가???     p.310
********************************/

CREATE TABLE TESTTBL1_39_14 (A NUMBER(10));
CREATE TABLE TESTTBL2_39_14 (A NUMBER(10));
CREATE TABLE TESTTBL3_39_14 (A NUMBER(10));

INSERT INTO TESTTBL1_39_14 VALUES (1);
INSERT INTO TESTTBL1_39_14 VALUES (2);
INSERT INTO TESTTBL1_39_14 VALUES (3);
INSERT INTO TESTTBL1_39_14 VALUES (4);
INSERT INTO TESTTBL1_39_14 VALUES (5);
INSERT INTO TESTTBL1_39_14 VALUES (6);

INSERT INTO TESTTBL2_39_14 VALUES (3);
INSERT INTO TESTTBL2_39_14 VALUES (7);
INSERT INTO TESTTBL2_39_14 VALUES (8);

INSERT INTO TESTTBL3_39_14 VALUES (4);
INSERT INTO TESTTBL3_39_14 VALUES (5);
INSERT INTO TESTTBL3_39_14 VALUES (6);

SELECT * FROM TESTTBL1_39_14
    UNION ALL
SELECT * FROM TESTTBL2_39_14
    MINUS
SELECT * FROM TESTTBL3_39_14;

/*******************************
    18. CUBE를 다른 방식으로 표현하기 p.311
********************************/
SELECT DEPTNO, JOB FROM EMP
GROUP BY CUBE(DEPTNO, JOB);

-- 2번보기
SELECT DEPTNO, JOB FROM EMP
GROUP BY GROUPING SETS(DEPTNO, JOB, (DEPTNO, JOB), NULL);

SELECT DEPTNO FROM EMP
GROUP BY DEPTNO;

/*******************************
    26. GROUP BY와 ORDER BY의 결합시 결과는?
********************************/

CREATE TABLE TESTTBL_39_26 (ID NUMBER(10));
INSERT INTO TESTTBL_39_26 VALUES (1000);
INSERT INTO TESTTBL_39_26 VALUES (1000);
INSERT INTO TESTTBL_39_26 VALUES (1000);
INSERT INTO TESTTBL_39_26 VALUES (3000);
INSERT INTO TESTTBL_39_26 VALUES (3000);
INSERT INTO TESTTBL_39_26 VALUES (4000);
INSERT INTO TESTTBL_39_26 VALUES (9999);
INSERT INTO TESTTBL_39_26 VALUES (9999);

SELECT * FROM TESTTBL_39_26;

-- 문제를 잘 읽어보면 그루핑을 하되 카운트가 2개인 것들만 추린다.
-- 두개 이상으로 잘못 읽어서 틀린 케이스.
SELECT ID FROM TESTTBL_39_26
GROUP BY ID HAVING COUNT(*) = 2;

SELECT ID FROM TESTTBL_39_26
GROUP BY ID HAVING COUNT(*) = 2
ORDER BY (CASE WHEN ID=1000 THEN 0 ELSE ID END); -- 1000은 집계되지 않음. 따라서 데이터 순서대로

SELECT ID FROM TESTTBL_39_26
GROUP BY ID HAVING COUNT(*) = 2
ORDER BY (DECODE(ID, 1000, 0, ID)); -- CASE WHEN...을 DECODE로 표현


SELECT * FROM EMP
WHERE EMPNO > 0
ORDER BY EMPNO DESC;